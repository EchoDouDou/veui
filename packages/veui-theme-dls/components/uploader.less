@import "../lib.less";

.@{veui-prefix}-uploader {
  display: flex;
  outline: none;
  font-size: @dls-uploader-font-size-m;

  .@{veui-prefix}-icon {
    color: @dls-uploader-file-item-font-color;
  }

  .@{veui-prefix}-disabled .@{veui-prefix}-icon {
    color: currentColor;
  }

  &-file {
    flex-direction: column;
  }

  &-button-container {
    display: flex;
    position: relative;
    overflow: hidden;
    align-items: center;
  }

  &-input-label-image {
    display: flex;
    .size(100%);
    border: none;

    .@{veui-prefix}-icon {
      .dls-icon-size(@dls-uploader-image-icon-size);
      margin: auto;
    }
  }

  &-list,
  &-list-image {
    padding: 0;
    margin: 0;
    list-style: none;

    &-item {
      position: relative;
      .veui-transition(transform);
    }

    .@{veui-prefix}-uploader-success-icon {
      color: @dls-uploader-success-color;
    }
    .@{veui-prefix}-uploader-failure-icon {
      color: @dls-uploader-error-color;
    }
  }

  &-list {
    &-item {
      margin: @dls-uploader-file-item-spacing-y 0;
      width: @dls-uploader-file-item-width;
    }

    &-container {
      display: flex;
      align-items: center;
      position: relative;
      background-color: @dls-uploader-file-item-background-color;
      .veui-transition(background-color);
      padding: 0 @dls-uploader-file-item-padding-x;
    }

    &-container:hover {
      background-color: @dls-uploader-file-item-background-color-hover;

      .@{veui-prefix}-uploader-list-remove {
        display: inline-flex;
      }

      .@{veui-prefix}-uploader-success-icon,
      .@{veui-prefix}-uploader-failure-icon {
        display: none;
      }
    }

    &-name {
      .ellipsis();
      margin: 0 @dls-uploader-file-item-label-spacing-after 0
        @dls-uploader-file-item-label-spacing-before;
    }
    &-name-failure {
      color: @dls-uploader-error-color;
    }
    &-file-icon,
    &-loading-icon {
      &-failure {
        color: @dls-uploader-error-color;
      }
    }

    .@{veui-prefix}-button&-remove {
      margin-left: auto;
      display: none;
    }

    .@{veui-prefix}-progress {
      .absolute(
        _,
        @dls-uploader-file-item-padding-x,
        -@dls-uploader-file-item-spacing-y / 2,
        @dls-uploader-file-item-padding-x
      );
      transform: translateY(-50%);
    }
    .@{veui-prefix}-progress .@{veui-prefix}-progress-rail {
      width: 100%;
    }
  }
  &-list-image {
    display: flex;
    flex-wrap: wrap;
    margin-top: -36px;
    &-item,
    &-upload-item {
      margin-top: 36px;
    }
    &-item + &-item,
    &-upload-item {
      margin-left: @dls-uploader-image-spacing-x;
    }
    &-container {
      display: flex;
      .size(@dls-uploader-image-width, @dls-uploader-image-height);
      position: relative;
      border-radius: @dls-button-border-radius-m;
      border: 1px solid @dls-button-border-color-normal;
      &-image {
        width: auto;
        height: auto;
        max-width: 100%;
        max-height: 100%;
        .veui-position-center();
      }
    }
    &-container:hover &-mask {
      opacity: 1;
    }
    &-container-uploading {
      flex-direction: column;
      align-items: center;
      padding: @dls-uploader-image-padding-top @dls-uploader-image-padding-x 0;
      &-text {
        margin: 0;
      }
      .@{veui-prefix}-progress {
        width: 100%;
        height: auto;
        margin-top: @dls-uploader-image-progress-spacing-before;
      }
    }
    &-container-failure {
      border-color: @dls-uploader-error-color;
    }
    &-mask {
      display: flex;
      justify-content: flex-end;
      align-items: center;
      opacity: 0;
      .veui-transition(opacity);
      .absolute(_, 0, 0, 0);
      background-color: fade(#000, @dls-uploader-mask-opacity * 100);
      padding: @dls-uploader-mask-padding-y @dls-uploader-mask-padding-x;
      .@{veui-prefix}-icon {
        color: @dls-uploader-mask-icon-color;
      }
      .@{veui-prefix}-button + .@{veui-prefix}-button {
        margin-left: @dls-uploader-mask-icon-spacing;
      }
    }
    &-failure-text {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      .absolute(
        dls-sum(@dls-uploader-image-height, @dls-uploader-image-error-spacing),
        0,
        _,
        0
      );
      color: @dls-uploader-error-color;
      margin: 0;
      .@{veui-prefix}-icon {
        margin-left: @dls-uploader-image-error-spacing;
        color: currentColor;
      }
    }
  }

  &-preview-dialog {
    &-image {
      min-width: @dls-uploader-image-preview-min-width;
      max-width: @dls-uploader-image-preview-max-width;
    }
  }

  &-desc {
    color: @dls-uploader-helper-text-font-color;
    margin-left: @dls-uploader-helper-text-spacing-x;
  }
  &-desc-vertical {
    flex-direction: column;
    .@{veui-prefix}-uploader-desc {
      margin-left: 0;
      margin-top: @dls-uploader-helper-text-spacing-y;
    }
  }

  &-image &-desc {
    // todo: image desc spacing-x variable
    margin-left: 12px;
    display: inline-flex;
    align-items: center;
  }
  &-image&-desc-vertical &-desc {
    // todo: image desc spacing-y variable
    margin: 0 0 12px 0;
  }
  &-desc-vertical &-button-container {
    flex-direction: column;
    align-items: flex-start;
  }

  &[ui~="s"] {
    font-size: @dls-uploader-font-size-s;
    .@{veui-prefix}-uploader-list-image-container {
      border-radius: @dls-button-border-radius-s;
    }
  }

  &-hide {
    display: none;
  }
  &-list-enter,
  &-list-leave-to {
    opacity: 0;
  }
  &-list-leave-active {
    position: absolute;
  }
  &-list-fade-leave-active {
    opacity: 0;
    .veui-transition(opacity);
  }
}
